"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Command line parser for CLI
 */
class CommandLineParser {
    parse(argv) {
        if (argv) {
            if (argv.length > 0) {
                this._interpreter = argv[0];
            }
            if (argv.length > 1) {
                this._script = argv[1];
            }
            let argStart = 2;
            if (argv.length > 2) {
                if (!argv[2].startsWith("--")) {
                    this._command = argv[2];
                    argStart++;
                }
            }
            if (argv.length > argStart) {
                this._arguments = {};
                for (let i = argStart; i < argv.length; i++) {
                    let arg = argv[i];
                    if (arg.startsWith("--")) {
                        arg = arg.substring(2);
                        const eqIndex = arg.indexOf("=");
                        if (eqIndex === -1) {
                            this._arguments[arg] = null;
                        }
                        else {
                            this._arguments[arg.substring(0, eqIndex)] = arg.substring(eqIndex + 1);
                        }
                    }
                }
            }
        }
    }
    getScript() {
        return this._script;
    }
    getCommand() {
        return this._command;
    }
    getArguments(exclude) {
        if (this._arguments && exclude && exclude.length > 0) {
            const newArgs = {};
            Object.keys(this._arguments)
                .filter((argKey) => exclude.indexOf(argKey) === -1)
                .forEach((argKey) => {
                newArgs[argKey] = this._arguments[argKey];
            });
            return newArgs;
        }
        else {
            return this._arguments;
        }
    }
    getArgument(argumentName) {
        return this._arguments ? this._arguments[argumentName] : undefined;
    }
    getNumberArgument(argumentName) {
        const arg = this.getArgument(argumentName);
        if (arg === undefined) {
            return undefined;
        }
        else if (arg === null) {
            return null;
        }
        else {
            const val = parseInt(arg, 10);
            return isNaN(val) ? undefined : val;
        }
    }
    getStringArgument(argumentName) {
        const arg = this.getArgument(argumentName);
        if (arg === undefined) {
            return undefined;
        }
        else if (arg === null) {
            return null;
        }
        else {
            if (arg.length >= 2 && arg.startsWith("\"") && arg.endsWith("\"")) {
                return arg.substring(1, arg.length - 2).trim();
            }
            else {
                return arg.trim();
            }
        }
    }
    hasArgument(argumentName) {
        return this._arguments && argumentName in this._arguments;
    }
}
exports.CommandLineParser = CommandLineParser;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tYW5kTGluZVBhcnNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOztHQUVHO0FBQ0g7SUFNVyxLQUFLLENBQUMsSUFBYztRQUN2QixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ1AsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNsQixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxDQUFDO1lBQ0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNsQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMzQixDQUFDO1lBQ0QsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDO1lBQ2pCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbEIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDNUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ3hCLFFBQVEsRUFBRSxDQUFDO2dCQUNmLENBQUM7WUFDTCxDQUFDO1lBQ0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDO2dCQUN6QixJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztnQkFFckIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsUUFBUSxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7b0JBQzFDLElBQUksR0FBRyxHQUFHLElBQUks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cEIsTUFBTSxDQUFDLFNBQVMsQ0FBQztRQUNyQixDQUFDO1FBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ3RCLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDaEIsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDaEUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDbkQsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDdEIsQ0FBQztRQUNMLENBQUM7SUFDTCxDQUFDO0lBRU0sV0FBVyxDQUFDLFlBQW9CO1FBQ25DLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxJQUFJLFlBQVksSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQzlELENBQUM7Q0FDSjtBQXJHRCw4Q0FxR0MiLCJmaWxlIjoiY29tbWFuZExpbmVQYXJzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvbW1hbmQgbGluZSBwYXJzZXIgZm9yIENMSVxuICovXG5leHBvcnQgY2xhc3MgQ29tbWFuZExpbmVQYXJzZXIge1xuICAgIHByaXZhdGUgX2ludGVycHJldGVyOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfc2NyaXB0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfY29tbWFuZDogc3RyaW5nO1xuICAgIHByaXZhdGUgX2FyZ3VtZW50czogeyBbaWQ6IHN0cmluZ106IHN0cmluZyB8IG51bGwgfTtcblxuICAgIHB1YmxpYyBwYXJzZShhcmd2OiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBpZiAoYXJndikge1xuICAgICAgICAgICAgaWYgKGFyZ3YubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVycHJldGVyID0gYXJndlswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcmd2Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zY3JpcHQgPSBhcmd2WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGFyZ1N0YXJ0ID0gMjtcbiAgICAgICAgICAgIGlmIChhcmd2Lmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFyZ3ZbMl0uc3RhcnRzV2l0aChcIi0tXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbW1hbmQgPSBhcmd2WzJdO1xuICAgICAgICAgICAgICAgICAgICBhcmdTdGFydCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcmd2Lmxlbmd0aCA+IGFyZ1N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJndW1lbnRzID0ge307XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gYXJnU3RhcnQ7IGkgPCBhcmd2Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhcmcgPSBhcmd2W2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJnLnN0YXJ0c1dpdGgoXCItLVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnLnN1YnN0cmluZygyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVxSW5kZXg6IG51bWJlciA9IGFyZy5pbmRleE9mKFwiPVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcUluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FyZ3VtZW50c1thcmddID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJndW1lbnRzW2FyZy5zdWJzdHJpbmcoMCwgZXFJbmRleCldID0gYXJnLnN1YnN0cmluZyhlcUluZGV4ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0U2NyaXB0KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zY3JpcHQ7XG4gICAgfVxuXG4gICAgcHVibGljIGdldENvbW1hbmQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbW1hbmQ7XG4gICAgfVxuXG4gICAgcHVibGljIGdldEFyZ3VtZW50cyhleGNsdWRlPzogc3RyaW5nW10pOiB7IFtpZDogc3RyaW5nXTogc3RyaW5nIHwgbnVsbCB9IHtcbiAgICAgICAgaWYgKHRoaXMuX2FyZ3VtZW50cyAmJiBleGNsdWRlICYmIGV4Y2x1ZGUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgbmV3QXJnczogeyBbaWQ6IHN0cmluZ106IHN0cmluZyB8IG51bGwgfSA9IHt9O1xuXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLl9hcmd1bWVudHMpXG4gICAgICAgICAgICAgICAgLmZpbHRlcigoYXJnS2V5KSA9PiBleGNsdWRlLmluZGV4T2YoYXJnS2V5KSA9PT0gLTEpXG4gICAgICAgICAgICAgICAgLmZvckVhY2goKGFyZ0tleSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBuZXdBcmdzW2FyZ0tleV0gPSB0aGlzLl9hcmd1bWVudHNbYXJnS2V5XTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIG5ld0FyZ3M7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXJndW1lbnRzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldEFyZ3VtZW50KGFyZ3VtZW50TmFtZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcmd1bWVudHMgPyB0aGlzLl9hcmd1bWVudHNbYXJndW1lbnROYW1lXSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0TnVtYmVyQXJndW1lbnQoYXJndW1lbnROYW1lOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsIHtcbiAgICAgICAgY29uc3QgYXJnID0gdGhpcy5nZXRBcmd1bWVudChhcmd1bWVudE5hbWUpO1xuXG4gICAgICAgIGlmIChhcmcgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIGlmIChhcmcgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdmFsID0gcGFyc2VJbnQoYXJnLCAxMCk7XG5cbiAgICAgICAgICAgIHJldHVybiBpc05hTih2YWwpID8gdW5kZWZpbmVkIDogdmFsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldFN0cmluZ0FyZ3VtZW50KGFyZ3VtZW50TmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGFyZyA9IHRoaXMuZ2V0QXJndW1lbnQoYXJndW1lbnROYW1lKTtcblxuICAgICAgICBpZiAoYXJnID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAoYXJnID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhcmcubGVuZ3RoID49IDIgJiYgYXJnLnN0YXJ0c1dpdGgoXCJcXFwiXCIpICYmIGFyZy5lbmRzV2l0aChcIlxcXCJcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJnLnN1YnN0cmluZygxLCBhcmcubGVuZ3RoIC0gMikudHJpbSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJnLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBoYXNBcmd1bWVudChhcmd1bWVudE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJndW1lbnRzICYmIGFyZ3VtZW50TmFtZSBpbiB0aGlzLl9hcmd1bWVudHM7XG4gICAgfVxufVxuIl19
